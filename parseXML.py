xml = '''<TaxId>330314</TaxId>
    <ScientificName>Parnassius mnemosyne ochraceus</ScientificName>
    <OtherNames>
        <Synonym>Parnassius mnemosyne ochracea</Synonym>
        <Name>
            <ClassCDE>authority</ClassCDE>
            <DispName>Parnassius mnemosyne ochraceus Austaut, 1891</DispName>
        </Name>
    </OtherNames>
    <ParentTaxId>213953</ParentTaxId>
    <Rank>subspecies</Rank>
    <Division>Invertebrates</Division>
    <GeneticCode>
        <GCId>1</GCId>
        <GCName>Standard</GCName>
    </GeneticCode>
    <MitoGeneticCode>
        <MGCId>5</MGCId>
        <MGCName>Invertebrate Mitochondrial</MGCName>
    </MitoGeneticCode>
    <Lineage>cellular organisms; Eukaryota; Opisthokonta; Metazoa; Eumetazoa; Bilateria; Protostomia; Ecdysozoa; Panarthropoda; Arthropoda; Mandibulata; Pancrustacea; Hexapoda; Insecta; Dicondylia; Pterygota; Neoptera; Endopterygota; Amphiesmenoptera; Lepidoptera; Glossata; Neolepidoptera; Heteroneura; Ditrysia; Obtectomera; Papilionoidea; Papilionidae; Parnassiinae; Parnassini; Parnassius; Driopa; Parnassius mnemosyne</Lineage>
    <LineageEx>
        <Taxon>
            <TaxId>131567</TaxId>
            <ScientificName>cellular organisms</ScientificName>
            <Rank>no rank</Rank>
        </Taxon>
        <Taxon>
            <TaxId>2759</TaxId>
            <ScientificName>Eukaryota</ScientificName>
            <Rank>superkingdom</Rank>
        </Taxon>
        <Taxon>
            <TaxId>33154</TaxId>
            <ScientificName>Opisthokonta</ScientificName>
            <Rank>clade</Rank>
        </Taxon>
        <Taxon>
            <TaxId>33208</TaxId>
            <ScientificName>Metazoa</ScientificName>
            <Rank>kingdom</Rank>
        </Taxon>
        <Taxon>
            <TaxId>6072</TaxId>
            <ScientificName>Eumetazoa</ScientificName>
            <Rank>clade</Rank>
        </Taxon>
        <Taxon>
            <TaxId>33213</TaxId>
            <ScientificName>Bilateria</ScientificName>
            <Rank>clade</Rank>
        </Taxon>
        <Taxon>
            <TaxId>33317</TaxId>
            <ScientificName>Protostomia</ScientificName>
            <Rank>clade</Rank>
        </Taxon>
        <Taxon>
            <TaxId>1206794</TaxId>
            <ScientificName>Ecdysozoa</ScientificName>
            <Rank>clade</Rank>
        </Taxon>
        <Taxon>
            <TaxId>88770</TaxId>
            <ScientificName>Panarthropoda</ScientificName>
            <Rank>clade</Rank>
        </Taxon>
        <Taxon>
            <TaxId>6656</TaxId>
            <ScientificName>Arthropoda</ScientificName>
            <Rank>phylum</Rank>
        </Taxon>
        <Taxon>
            <TaxId>197563</TaxId>
            <ScientificName>Mandibulata</ScientificName>
            <Rank>clade</Rank>
        </Taxon>
        <Taxon>
            <TaxId>197562</TaxId>
            <ScientificName>Pancrustacea</ScientificName>
            <Rank>clade</Rank>
        </Taxon>
        <Taxon>
            <TaxId>6960</TaxId>
            <ScientificName>Hexapoda</ScientificName>
            <Rank>subphylum</Rank>
        </Taxon>
        <Taxon>
            <TaxId>50557</TaxId>
            <ScientificName>Insecta</ScientificName>
            <Rank>class</Rank>
        </Taxon>
        <Taxon>
            <TaxId>85512</TaxId>
            <ScientificName>Dicondylia</ScientificName>
            <Rank>clade</Rank>
        </Taxon>
        <Taxon>
            <TaxId>7496</TaxId>
            <ScientificName>Pterygota</ScientificName>
            <Rank>subclass</Rank>
        </Taxon>
        <Taxon>
            <TaxId>33340</TaxId>
            <ScientificName>Neoptera</ScientificName>
            <Rank>infraclass</Rank>
        </Taxon>
        <Taxon>
            <TaxId>33392</TaxId>
            <ScientificName>Endopterygota</ScientificName>
            <Rank>cohort</Rank>
        </Taxon>
        <Taxon>
            <TaxId>85604</TaxId>
            <ScientificName>Amphiesmenoptera</ScientificName>
            <Rank>superorder</Rank>
        </Taxon>
        <Taxon>
            <TaxId>7088</TaxId>
            <ScientificName>Lepidoptera</ScientificName>
            <Rank>order</Rank>
        </Taxon>
        <Taxon>
            <TaxId>41191</TaxId>
            <ScientificName>Glossata</ScientificName>
            <Rank>suborder</Rank>
        </Taxon>
        <Taxon>
            <TaxId>41196</TaxId>
            <ScientificName>Neolepidoptera</ScientificName>
            <Rank>infraorder</Rank>
        </Taxon>
        <Taxon>
            <TaxId>41197</TaxId>
            <ScientificName>Heteroneura</ScientificName>
            <Rank>parvorder</Rank>
        </Taxon>
        <Taxon>
            <TaxId>37567</TaxId>
            <ScientificName>Ditrysia</ScientificName>
            <Rank>clade</Rank>
        </Taxon>
        <Taxon>
            <TaxId>104431</TaxId>
            <ScientificName>Obtectomera</ScientificName>
            <Rank>clade</Rank>
        </Taxon>
        <Taxon>
            <TaxId>37572</TaxId>
            <ScientificName>Papilionoidea</ScientificName>
            <Rank>superfamily</Rank>
        </Taxon>
        <Taxon>
            <TaxId>7143</TaxId>
            <ScientificName>Papilionidae</ScientificName>
            <Rank>family</Rank>
        </Taxon>
        <Taxon>
            <TaxId>42290</TaxId>
            <ScientificName>Parnassiinae</ScientificName>
            <Rank>subfamily</Rank>
        </Taxon>
        <Taxon>
            <TaxId>213899</TaxId>
            <ScientificName>Parnassini</ScientificName>
            <Rank>tribe</Rank>
        </Taxon>
        <Taxon>
            <TaxId>42291</TaxId>
            <ScientificName>Parnassius</ScientificName>
            <Rank>genus</Rank>
        </Taxon>
        <Taxon>
            <TaxId>447264</TaxId>
            <ScientificName>Driopa</ScientificName>
            <Rank>subgenus</Rank>
        </Taxon>
        <Taxon>
            <TaxId>213953</TaxId>
            <ScientificName>Parnassius mnemosyne</ScientificName>
            <Rank>species</Rank>
        </Taxon>
    </LineageEx>
    <CreateDate>2005/05/25 09:22:24</CreateDate>
    <UpdateDate>2018/11/26 11:54:50</UpdateDate>
    <PubDate>2008/02/29 18:00:18</PubDate>
</Taxon>

</TaxaSet>'''


"""
    takes a string and parse it as xml format to extract the available taxonomy
    

    INPUTS: parseClassifXML(xml) 
        xml: string
    OUTPUTS:
        classif: dict
"""
def parseClassifXML(xml):
    classif = {}

    if "</ScientificName>" in xml and "<ScientificName>" in xml:
        scientificName, newXml = xml.split('</ScientificName>', 1)
        _, scientificName = scientificName.split('<ScientificName>', 1)
        classif['ScientificName'] = scientificName

    if "</LineageEx>" in xml and "<LineageEx>" in xml:
        lineageInfo, _ = xml.split("</LineageEx>", 1)
        _, lineageInfo = lineageInfo.split("<LineageEx>", 1)
        taxons = lineageInfo.split("</Taxon>")
        
        for taxon in taxons:
            keys = classif.keys()
            # print(f'taxon: {taxon}')
            if "</ScientificName>" in taxon and "<ScientificName>" in taxon and "<Rank>" in taxon and "</Rank>" in taxon:
                name, _ = taxon.split("</ScientificName>", 1)
                _, name = name.split("<ScientificName>", 1)
                name = name.replace(" ", "_")
                rank, _ = taxon.split("</Rank>", 1)
                # print(f'Rank1 {rank}')
                _, rank= rank.split("<Rank>", 1)
                rank = rank.replace(" ", "_")
                # print(f'Rank2 {rank}')
                if rank == 'clade':
                    print(keys)
                    if rank not in keys: 
                        classif['clade'] = [name]
                    else:
                        print(type(classif['clade']))
                        classif['clade'].append(name)
                else:
                    classif[rank] = name

    print(f'classif: {classif}')

    return classif

parseClassifXML(xml)